function Alter(){var e=this;e.maskwapper=$(".mask-wapper-add"),e.scollwapper=$(".scoll-wapper"),e.maskwapper_Review=$(".mask-wapper-Review")}Alter.prototype.run=function(){var e=this;e.listenshowhideEvent(),e.listenSigninEvent(),e.listenreviseEvent(),e.listenDeleteEvent(),e.listenDataPiker(),e.listenselectnow(),e.listenReviewEvent(),e.listenReviewSbumitEvent(),e.listenreviewEvent()},Alter.prototype.showEvent=function(){this.maskwapper.show()},Alter.prototype.showReviewEvent=function(){this.maskwapper_Review.show()},Alter.prototype.hideEvent=function(){this.maskwapper.hide(),this.maskwapper_Review.hide()},Alter.prototype.listenshowhideEvent=function(){var s=this,e=$(".add-btn"),t=$(".editor-btn"),n=$(".close-btn"),a=$(".revise-btn"),i=$(".cancle-btn");$(".Review-btn");t.click(function(){s.showEvent(),s.scollwapper.css({left:"-500px"});var e=$(this);tr=e.parent().parent();var t=tr.attr("id"),n=tr.attr("AlterType"),a=tr.attr("AssociatedNumber"),i=tr.attr("Database"),o=tr.attr("AlterContent"),l=tr.attr("Informant"),r=tr.attr("FillTime");$("#ID-id").val(t),$("#ID-AlterType").val(n),$("#ID-AssociatedNumber").val(a),$("#ID-Database").val(i),$("#ID-AlterContent").val(o),$("#ID-Informant").val(l),$("#ID-FillTime").val(r),console.log("ID："+t),console.log("提交时间："+r),console.log("提交人："+l),console.log("关联编号："+a),console.log("变更内容："+o)}),e.click(function(){event.preventDefault(),s.showEvent(),s.scollwapper.css({left:"0"})}),n.click(function(){s.hideEvent()}),a.click(function(){}),i.click(function(){s.hideEvent()})},Alter.prototype.listenreviseEvent=function(){var e=$(".revise-group"),l=e.find("input[name='AlterID']"),r=e.find("select[name='AltType']"),s=e.find("input[name='AssociatedNumber']"),c=e.find("select[name='Database']"),u=e.find("textarea[name='AlterContent']");e.find(".revise-btn").click(function(){var t=l.val(),n=r.val(),a=s.val(),i=c.val(),o=u.val();Swal.fire({type:"question",title:"确认修改吗？",showConfirmButton:!0,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确认",cancelButtonText:"取消",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger",buttonsStyling:!1}).then(function(e){e.value?Swal.fire({tiele:"已提交！",text:"提交成功。",type:"success",timer:1e3}).then(function(){xfzajax.post({url:"/alter/edit_Alter_manager/",data:{id:t,AltType:n,AssociatedNumber:a,Database:i,AlterContent:o},success:function(e){200===e.code&&Swal.fire({title:"已修改",text:"修改成功",type:"success",timer:1e3}).then(function(){window.location.reload()})}})}):e.dismiss===Swal.DismissReason.cancel&&Swal.fire("已取消！","你的数据是安全的:)","error")})})},Alter.prototype.listenSigninEvent=function(){var e=$(".Add-group"),i=e.find("select[name='AltType']"),o=e.find("input[name='AssociatedNumber']"),l=e.find("select[name='Database']"),r=e.find("textarea[name='AlterContent']");e.find(".submit-btn").click(function(){event.preventDefault();var e=i.val(),t=o.val(),n=l.val(),a=r.val();xfzajax.post({url:"/alter/add_Alter_manager/",data:{AltType:e,AssociatedNumber:t,Database:n,AlterContent:a},success:function(e){200===e.code&&swal.fire("添加成功","已经成功添加","success").then(function(){setTimeout("window.location.reload()","300")})}})})},Alter.prototype.listenDeleteEvent=function(){$(".delete-btn").click(function(){var t=$(this).parent().parent().attr("id");Swal.fire({type:"warning",title:"确认删除吗？",text:"数据删除后不能恢复哦!",showLoaderOnConfirm:!0,showConfirmButton:!0,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确认",cancelButtonText:"取消",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger",buttonsStyling:!1}).then(function(e){if(e.dismiss===Swal.DismissReason.cancel)return Swal.fire("已取消！","你的数据是安全的:)","error"),void console.log("用户取消！");xfzajax.post({url:"/alter/delete_Alter_manager/",data:{id:t},success:function(e){200===e.code?Swal.fire("已删除！","删除成功。","success").then(function(){window.location.reload()}):window.messageBox.showError(e.message)}})})})},Alter.prototype.listenDataPiker=function(){var e=$("#start-picker"),t=$("#end-picker"),n=new Date,a={format:"yyyy/mm/dd",language:"zh-CN",formatDate:"Y/m/d",minView:"month",validateOnBlur:!0,endDate:n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate(),todayBtn:"linked",todayHighlight:!0,clearBtn:!0,autoclose:!0};e.datetimepicker(a),t.datetimepicker(a)},getchecked=function(){for(var e=document.getElementsByName("se"),t=0;t<e.length;t++)if(1==e[t].checked)return e[t]},Alter.prototype.listenReviewEvent=function(){var n=this;$(".Review-btn").click(function(e){e.preventDefault();var t=getchecked();if(t){t.parentElement.parentElement.getAttribute("alterid");n.showReviewEvent()}else alert("一个没有选中")})},Alter.prototype.listenselectnow=function(){$(".box-footer"),$(".box-header");var t=$(".tr-line");t.click(function(){var e=$(this);e.addClass("colour").siblings("tr.colour").removeClass("colour"),ckbox=e.children().children(),t.find("input[type='checkbox']").prop("checked",!1),ckbox.prop("checked",!0)})},Alter.prototype.listenReviewSbumitEvent=function(){var e=$(".Review-group"),t=$(".Reviewsub-btn"),a=e.find("textarea[name='ReviewContent']");t.click(function(){var e=$("input:radio[name='Reviewstatus']:checked").val(),t=getchecked().parentElement.parentElement.getAttribute("id"),n=a.val();xfzajax.post({url:"/alter/Review_Alter_manager/",data:{id:t,ReviewStatus:e,ReviewContent:n},success:function(e){200===e.code&&Swal.fire("审核成功","审核提交成功啦","success").then(function(){window.location.reload()})}})})},Alter.prototype.listenreviewEvent=function(){$(".review-btn").click(function(e){e.preventDefault();var t=getchecked();if(t){var a=t.parentElement.parentElement.getAttribute("id");console.log("选中的id",a),$.ajax({url:"/alter/test_review/",type:"GET",data:{id:a},success:function(e){200===e.code?(console.log(e),$("#altcontect-input").val(e.data[0].reviewcontent),1==e.data[0].reviewstatus?(console.log("审核状态1",e.data[0].reviewstatus),$("#review-radio1").prop("checked",!0)):(console.log("审核状态2",e.data[0].reviewstatus),$("#review-radio2").prop("checked",!0))):console.log("请求失败，没有获取到数据！")}}),Swal.fire({title:"变更数据审核",html:'<div class="input-group" style="text-align: center;margin: auto;font-size: 14px">                                   <label  for="ReviewType">审核通过: </label>                                      <input id="review-radio1" type="radio" class="radio-btn" checked="" name="Reviewstatus" value="1">                                   <label style="margin-left: 15px" for="ReviewType">审核不通过: </label>                                      <input id="review-radio2" type="radio" class="radio-btn" name="Reviewstatus" value="2">                                </div><textarea  style="height: 100px;" id="altcontect-input" class="swal2-input"  rows="15" maxlength="1000" required="" placeholder="请输入审核内容"></textarea>',showCancelButton:!0,cancelButtonText:"取消操作",confirmButtonText:"确认审核"}).then(function(e){if(e.dismiss!==Swal.DismissReason.cancel&&e.dismiss!==Swal.DismissReason.backdrop){var t=$('input[name="Reviewstatus"]:checked').val(),n=$("#altcontect-input").val();console.log("判断条件",t),console.log("输入内容",n),xfzajax.post({url:"/alter/Review_Alter_manager/",data:{id:a,ReviewStatus:t,ReviewContent:n},success:function(e){200===e.code?Swal.fire("审核成功","审核提交成功啦","success").then(function(){window.location.reload()}):window.messageBox.showError(e.message)}})}else console.log("用户取消！")})}else console.log("请选中一条数据！"),window.messageBox.showError("请选中一条数据！")})},$(function(){(new Alter).run()});